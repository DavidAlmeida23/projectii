\documentclass[12pt]{article}
\usepackage{indentfirst}
\usepackage{graphicx}
\usepackage[margin=1.3in, top=1.4in]{geometry}
\usepackage[section]{placeins}
\usepackage{booktabs}
\usepackage{tabularx} 
\usepackage{tabulary}
\usepackage{cutwin}
\usepackage{caption}
\usepackage{lipsum}
\usepackage{wrapfig}
\usepackage[T1]{fontenc}
\usepackage{color}
\usepackage{eurosym}
\usepackage{glossaries}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage[utf8x]{inputenc}
\usepackage{url}
\usepackage[hidelinks]{hyperref}
\usepackage{float}
\usepackage[table,xcdraw]{xcolor}
\usepackage{dirtree}
\usepackage[title,titletoc,toc]{appendix}

\usepackage[justification=centering]{caption}


\usepackage{listings}
\usepackage{color}
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}


%%%TAB COMAND
\newcommand\tab[1][1cm]{\hspace*{#1}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%subsubsubsection
\usepackage{titlesec}
%\usepackage{hyperref}
\titleclass{\subsubsubsection}{straight}[\subsection]
\newcounter{subsubsubsection}[subsubsection]
\renewcommand\thesubsubsubsection{\thesubsubsection.\arabic{subsubsubsection}}
\renewcommand\theparagraph{\thesubsubsubsection.\arabic{paragraph}} % optional; useful if paragraphs are to be numbered
\titleformat{\subsubsubsection}
  {\normalfont\normalsize\bfseries}{\thesubsubsubsection}{1em}{}
\titlespacing*{\subsubsubsection}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\makeatletter
\renewcommand\paragraph{\@startsection{paragraph}{5}{\z@}%
  {3.25ex \@plus1ex \@minus.2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\renewcommand\subparagraph{\@startsection{subparagraph}{6}{\parindent}%
  {3.25ex \@plus1ex \@minus .2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\def\toclevel@subsubsubsection{4}
\def\toclevel@paragraph{5}
\def\toclevel@paragraph{6}
\def\l@subsubsubsection{\@dottedtocline{4}{7em}{4em}}
\def\l@paragraph{\@dottedtocline{5}{10em}{5em}}
\def\l@subparagraph{\@dottedtocline{6}{14em}{6em}}
\makeatother
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\sloppy

 \definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

% Define Language
\lstdefinelanguage{EL}
{
% list of keywords
morekeywords={language,
interface,
service,
services,
reference,
references,
properties,
int,
float,
string,
bool,
subcomponents,
component,
bind,
to,
promote,
as,
import,
compile },
sensitive=false, % keywords are not case-sensitive
morecomment=[l]{//}, % l is for line comment
morecomment=[s]{/*}{*/}, % s is for start and end delimiter
morestring=[b]" % defines that strings are enclosed in double quotes
}

% Set Language
\lstset{
%language={EL},
aboveskip=2\bigskipamount,
backgroundcolor=\color{white}, % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
basicstyle=\scriptsize, % the size of the fonts that are used for the code
breakatwhitespace=false, % sets if automatic breaks should only happen at whitespace
breaklines=true, % sets automatic line breaking
captionpos=b, % sets the caption-position to bottom
commentstyle=\color{mygreen}, % comment style
deletekeywords={...}, % if you want to delete keywords from the given language
escapeinside={\%*}{*)}, % if you want to add LaTeX within your code
extendedchars=true, % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
frame=lines, % adds a frame around the code
keepspaces=true, % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
keywordstyle=\color{blue}, % keyword style
% otherkeywords={*,language, interface,
% service, services, reference, references, properties, int, float, string, bool, subcomponents, component, bind, to, promote, as,import,compile, ...}, % if you want to add more keywords to the set
numbers=none, % where to put the line-numbers; possible values are (none, left, right)
numbersep=5pt, % how far the line-numbers are from the code
numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
rulecolor=\color{black}, % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
showspaces=false, % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
showstringspaces=false, % underline spaces within strings only
showtabs=false, % show tabs within strings adding particular underscores
stepnumber=2, % the step between two line-numbers. If it's 1, each line will be numbered
stringstyle=\color{mymauve}, % string literal style
tabsize=2, % sets default tabsize to 2 spaces
title=\lstname, % show the filename of files included with \lstinputlisting; also try caption instead of title
%xleftmargin=20.0pt,
%xrightmargin=20.0pt
}


%space between paragraphs
\setlength{\parskip}{0.8ex}

\begin{document}

\begin{titlepage}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here

\center % Center everything on the page
 
%----------------------------------------------------------------------------------------
%	HEADING SECTIONS
%----------------------------------------------------------------------------------------

\textsc{\LARGE FINAL REPORT}\\[1.0cm] % Major heading such as course name
\textsc{\Large Project II}\\[0.5cm] % Minor heading such as course title
\textsc{\large Embedded Systems Research Group}\\[0.5cm] % Minor heading such as course title

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\HRule \\[1.2cm]
{ \Huge \bfseries 
Modeling a Dynamic Binary Translator using a DSL}\\[1.0cm] % Title of your document 
{ \Large \bfseries 
Decoding Operands}\\[0.4cm]

\HRule \\[3.0cm]
 
%----------------------------------------------------------------------------------------
%	AUTHOR SECTION
%----------------------------------------------------------------------------------------
% Your name
\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Authors:}\\
David \textsc{Almeida} 68532 \\
Paulo \textsc{Félix} 61767  \\
Pedro \textsc{Guimarães} 68539 
\end{flushleft}
\end{minipage}
~
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
 \emph{Advisors:} \\
Filipe \textsc{Salgado} \\ % Supervisor's Name
Jorge \textsc{Cabral} % Supervisor's Name
\end{flushright}
\end{minipage}\\[2cm]

%----------------------------------------------------------------------------------------
%	LOGO SECTION
%----------------------------------------------------------------------------------------
%\includegraphics{Logo}\\[1cm] % Include a department/university logo - this will require the graphicx package
%----------------------------------------------------------------------------------------
\noindent\begin{minipage}{0.2\textwidth}
\includegraphics[width=\linewidth]{images/logo} \\[0.5cm] 
\end{minipage}%
\hfill%

{ \large \bfseries 
Universidade do Minho}\\[0.5cm] 

%----------------------------------------------------------------------------------------
%	DATE SECTION
%----------------------------------------------------------------------------------------
{\large \today}\\[3cm] % Date, change the \today to a set date if you want to be precise

\vfill % Fill the rest of the page with whitespace
\end{titlepage}


\begin{abstract}
\input{text/abstract}

\newpage
\end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Table of Contents
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\listfigurename}{Contents}
%\newpage
\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Table of Figures
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\listfigurename}{Figures}
%\newpage
\listoffigures

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Table of Tables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\listtablename}{Tables}
%\newpage
\listoftables

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Table of Listings
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newpage
\lstlistoflistings

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Glossaries
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newglossaryentry{utc}{name=UTC, description={Coordinated Universal Time}} %\gls{utc}
\printglossaries


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Introduction
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Introduction}
\subsection{Motivation and Main Goals}
\input{text/motivation}
\subsection{Report's Organization}
\input{text/organization}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theoretical Concepts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Theoretical Concepts}
\input{text/concepts}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% EL Framework
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\section{\textit{EL} Framework}
\input{text/chapter3}
\newpage
\section{Dynamic Binary Translator}
\input{text/chapter4}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Analysis 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Requirements Analysis and Project Definition}
\input{text/overview}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Use Cases
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Use Cases}
\input{text/usecases}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Requirements
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Requirements}
\input{text/requirements}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Constraints
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Constraints}
\input{text/constraints}

\subsection{Resources}
\input{text/resources}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Planning
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Planning}
\input{text/planning}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% DESGIN
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{System and Software Design}

\subsection {DBT Code Analysis}
\input{text/codeanalysis}

\subsection{DBT Component}
\input{text/dbtComponents}

\subsection{Decoder Component}
\input{text/decoders}

\subsection{Implementation Plan}
\input{text/implementationPlan}

\subsection{Test Cases}
\input{text/testCases}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  IMPLEMENTATION / TEST UNIT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\section{Implementation and Unit Testing}


\subsection{Code Refactoring}
\input{text/refactoring}

\subsection{Decoder Behaviors}
\input{text/decodersBehaviors}

\subsection {DBT Component}
\input{text/dbtImplement}
\subsection{Decoder Component}
\input{text/decoderImplement}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INTEGRATION / SYSTEM TESTING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Integration and System Testing}
\input{text/tests}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INTEGRATION / SYSTEM TESTING
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Conclusion and Future Perspectives}
\input{text/conclusion}

\newpage
\bibliographystyle{abbrv}
\bibliography{refs}

\newpage
\begin{appendices}
\huge \textbf{APPENDIX}
\end{appendices}


\begin{lstlisting} [language=EL, caption= Architecture (EL representation)]
import "Languages.el"
import "Interfaces.el"

component Architecture (C)
{
	services:
		i_ISA s_ISA
		i_MemSizes s_MemSizes
		i_Registers s_Registers
}

component SourceArch (C) is Architecture {}
component TargetArch (C) is Architecture {}
\end{lstlisting}


\begin{lstlisting} [language=EL, caption=CodeCache (EL representation)]
import "Interfaces.el"
import "Languages.el"

component CodeCache(C)
{
	properties:
		int CCache_Size : 32768							// 32*1014
		string SourceCode_Location : "0x60040000"		// Hexadecimal
	services:
		i_CCache s_CCache
	references:
		i_ISA r_ISA
}
\end{lstlisting}


\begin{lstlisting} [language=EL, caption=TranslationCache (EL representation)]
import "Languages.el"
import "Interfaces.el"

component TranslationCache(C)
{
	properties:
		int TCache_Size : 8192 		// 20Kbytes
		int numberOfTraductions : 1	
	services:
		i_TCache s_TCache
	references:
		i_ISA r_ISA	
}
\end{lstlisting}

\newpage
\begin{lstlisting} [language=EL, caption=SourceCluster (EL representation)]
import "Languages.el"
import "Interfaces.el"
import "Decoder.el"
import "Architectures.el"
import "SourceEnvironment.el"

component SourceCluster (C)
{
	subcomponents:
		Decoder decoder
		SourceArch srcArch
		SourceEnv srcEnv	
	 
	bind decoder.r_ISA 			to srcArch.s_ISA
	bind srcEnv.pr_MemSizes 	to srcArch.s_MemSizes
	bind decoder.r_Registers 	to srcArch.s_Registers
	bind decoder.r_SrcEnv		to srcEnv.s_SrcEnv
	
	promote service srcArch.s_MemSizes	 as ps_MemSizes
	promote service srcArch.s_ISA 		 as ps_ISA
	promote service srcArch.s_Registers  as ps_Registers 
	promote service srcEnv.s_SrcEnv 	 as ps_SrcEnv
	promote service srcEnv.ps_DMem		 as pps_DMem
	promote service decoder.s_Decode	 as ps_Decode
	
	promote reference decoder.r_Generate as pr_Generate
	promote reference decoder.r_CCache   as pr_CCache
	promote reference decoder.r_EngineState as pr_EngineState
}
\end{lstlisting}

\begin{lstlisting} [language=EL, caption=SourceEnv (EL representation)]
import "Languages.el"
import "Interfaces.el"
import "DataMemory.el"

component SourceEnv (C)
{
	subcomponents:
		DataMemory dataMem
	services:
		i_SrcEnv s_SrcEnv
		
	
	promote reference dataMem.r_MemSizes as pr_MemSizes
	promote service dataMem.s_DMem as ps_DMem
}
\end{lstlisting}

\newpage
\begin{lstlisting} [language=EL, caption=DataMemory (EL representation)]
import "Languages.el"
import "Interfaces.el"

component DataMemory(C)
{ 
	services:
		i_DMem s_DMem
	references:
		i_MemSizes r_MemSizes	// DataMem & xDataMem
}
\end{lstlisting}


\begin{lstlisting} [language=EL, caption=TargetCluster (EL representation)]
import "Languages.el"
import "Interfaces.el"
import "Generator.el"
import "Architectures.el"

component TargetCluster (C)
{
	subcomponents:
		TargetArch target
		Generator gen 
		
	bind gen.r_ISA to target.s_ISA
	bind gen.r_TrgRegisters to target.s_Registers
	
	promote reference gen.r_SrcRegisters as pr_SrcRegisters
	promote reference gen.r_SrcEnv 		 as pr_SrcEnv
	promote reference gen.r_TCache 		 as pr_TCache
	promote reference gen.r_DMem		 as pr_Dmem
	promote reference gen.r_EngineState  as pr_r_EngineState
	
	promote service target.s_MemSizes as ps_MemSizes
	promote service target.s_ISA as ps_ISA	
	promote service gen.s_Generate as ps_Generate
	
}
\end{lstlisting}

\begin{lstlisting} [language=EL, caption=Generator (EL representation)]
import "Languages.el"
import "Interfaces.el"

component Generator (C)
{
	properties:
		bool optimizations : false
		bool trgCodeTracing : true
	services:
		i_Generate s_Generate	
	references:
		i_Registers r_SrcRegisters
		i_Registers r_TrgRegisters
		i_SrcEnv r_SrcEnv
		i_ISA r_ISA
		i_TCache r_TCache
		i_DMem r_DMem				// Nova Referencia DavidRita
		i_EngineState r_EngineState
}
\end{lstlisting}


\begin{lstlisting} [language=EL, caption=DBTEngine (EL representation)]
import "Languages.el"
import "Interfaces.el"
import "Translator.el"
import "Executor.el"

component DBTEngine (C)
{
	subcomponents:
		Translator translate
		Executor execute
	services:   
		i_CurrBBExec s_CurrBBExec 
		i_Engine s_Engine   
		i_EngineState s_EngineState 	
	references:
		i_TCache r_TCache
		i_SrcEnv r_SrcEnv
		i_Translate r_Translate	
		i_Execute r_Execute
		i_CCache r_CCache
		
	bind r_Execute to execute.s_Execute
	bind r_Translate to translate.s_Translate
	bind execute.r_CurrBBExec to s_CurrBBExec
	promote reference execute.r_DMem as pr_DMem
	promote reference translate.r_Decode as pr_Decode
	promote reference translate.r_TCache as pr_TransTCache
	promote reference translate.r_Generate as pr_Generate

} 
\end{lstlisting}


\begin{lstlisting} [language=EL, caption=Translator (EL representation)]
import "Languages.el"
import "Interfaces.el"

component Translator (C)
{
	services:
		i_Translate s_Translate
	references:
		i_Decode r_Decode  
		i_TCache r_TCache
		i_Generate r_Generate
} 
\end{lstlisting}


\begin{lstlisting} [language=EL, caption=Executor (EL representation)]
import "Languages.el"
import "Interfaces.el"

component Executor (C)
{
	references:
		i_CurrBBExec r_CurrBBExec
		i_DMem r_DMem
	services:
		i_Execute s_Execute
}
\end{lstlisting}





\end{document}